[
  {
    "objectID": "prepare_geoinfo.html",
    "href": "prepare_geoinfo.html",
    "title": "Prepare geoinfo",
    "section": "",
    "text": "We downloaded images from Landasat 8, Sentinel 2 and MOD13Q1 to explore the grids generated.\nWe used a custom GEE script (see get_grid) and donwload GeoTiffs for each one of the satellites used. The geoTiffs were stored at ‘/data/geoinfo/grid/’\n\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\n\n\nGenerate custom wrapper to prepare polygons of the grids\n\n\ngrid_generate &lt;- function(v, raster_path){ \n  \n  valdemaqueda &lt;- v |&gt; filter(site == \"valdemaqueda\")\n  valsain &lt;- v |&gt; filter(str_detect(site, \"valsain\"))\n  \n  r &lt;- terra::rast(raster_path)\n  \n  r_valdemaqueda &lt;- crop(r, valdemaqueda) |&gt; terra::as.polygons(aggregate=FALSE)\n  r_valsain &lt;- crop(r, valsain) |&gt; terra::as.polygons(aggregate=FALSE)\n  \n  output &lt;- rbind(r_valdemaqueda, r_valsain)\n  \n  return(output)\n}\n\n\ng &lt;- st_read(\"data/geoinfo/guadarrama_dec_bbox.shp\")\n\nReading layer `guadarrama_dec_bbox' from data source \n  `/Users/ajpelu/Library/CloudStorage/GoogleDrive-ajperez@go.ugr.es/My Drive/_proyectos/mephyston/guadarrama_dec_spatial/data/geoinfo/guadarrama_dec_bbox.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3 features and 3 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -4.323987 ymin: 40.50376 xmax: -4.062268 ymax: 40.8638\nGeodetic CRS:  WGS 84\n\n\n\nl8 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_landsat8_mephyston.tiff\")\nwriteVector(l8, \"data/geoinfo/grid/l8.shp\", overwrite=TRUE)\n\ns2 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_sentinel2_mephyston.tiff\")\nwriteVector(s2, \"data/geoinfo/grid/s2.shp\", overwrite=TRUE)\n\nmod13 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_modis13q1_mephyston.tiff\")\nwriteVector(mod13, \"data/geoinfo/grid/mod13.shp\", overwrite=TRUE)"
  },
  {
    "objectID": "prepare_geoinfo.html#generate-grids-from-satellite",
    "href": "prepare_geoinfo.html#generate-grids-from-satellite",
    "title": "Prepare geoinfo",
    "section": "",
    "text": "We downloaded images from Landasat 8, Sentinel 2 and MOD13Q1 to explore the grids generated.\nWe used a custom GEE script (see get_grid) and donwload GeoTiffs for each one of the satellites used. The geoTiffs were stored at ‘/data/geoinfo/grid/’\n\n\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\n\n\nGenerate custom wrapper to prepare polygons of the grids\n\n\ngrid_generate &lt;- function(v, raster_path){ \n  \n  valdemaqueda &lt;- v |&gt; filter(site == \"valdemaqueda\")\n  valsain &lt;- v |&gt; filter(str_detect(site, \"valsain\"))\n  \n  r &lt;- terra::rast(raster_path)\n  \n  r_valdemaqueda &lt;- crop(r, valdemaqueda) |&gt; terra::as.polygons(aggregate=FALSE)\n  r_valsain &lt;- crop(r, valsain) |&gt; terra::as.polygons(aggregate=FALSE)\n  \n  output &lt;- rbind(r_valdemaqueda, r_valsain)\n  \n  return(output)\n}\n\n\ng &lt;- st_read(\"data/geoinfo/guadarrama_dec_bbox.shp\")\n\nReading layer `guadarrama_dec_bbox' from data source \n  `/Users/ajpelu/Library/CloudStorage/GoogleDrive-ajperez@go.ugr.es/My Drive/_proyectos/mephyston/guadarrama_dec_spatial/data/geoinfo/guadarrama_dec_bbox.shp' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3 features and 3 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: -4.323987 ymin: 40.50376 xmax: -4.062268 ymax: 40.8638\nGeodetic CRS:  WGS 84\n\n\n\nl8 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_landsat8_mephyston.tiff\")\nwriteVector(l8, \"data/geoinfo/grid/l8.shp\", overwrite=TRUE)\n\ns2 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_sentinel2_mephyston.tiff\")\nwriteVector(s2, \"data/geoinfo/grid/s2.shp\", overwrite=TRUE)\n\nmod13 &lt;- grid_generate(v = g, raster_path = \"data/geoinfo/grid/grid_modis13q1_mephyston.tiff\")\nwriteVector(mod13, \"data/geoinfo/grid/mod13.shp\", overwrite=TRUE)"
  },
  {
    "objectID": "prepare_geoinfo.html#limits-of-natural-protected-areas",
    "href": "prepare_geoinfo.html#limits-of-natural-protected-areas",
    "title": "Prepare geoinfo",
    "section": "Limits of Natural Protected areas",
    "text": "Limits of Natural Protected areas\n\nGet limits of PNac Guadarrama\n\nData source\n\n\npn &lt;- st_read(\"/Users/ajpelu/Downloads/limites_red/desc_Red_PN_LIM_Enero2023/Limite_PN_p_b.shp\")\n\ngnac &lt;- pn |&gt; \n  filter(str_detect(d_Nom_Parq, \"Guadarrama\")) |&gt; # Ojo existen 2, uno es la zona de Especial Proteccion\n  filter(d_Nom_Parq == \"Parque Nacional de la Sierra de Guadarrama\")\n\nst_write(gnac, \"data/geoinfo/pnac_guadarrama_limites.shp\")\n\n\n\nGet limits of Pnat Guadarrama (Castilla y León)\n\nData source\n\n\ncl &lt;- st_read(\"/Users/ajpelu/Downloads/ps.ren_cyl/ps.ren_cyl.shp\")\n\ngnat &lt;- cl |&gt; \n  filter(str_detect(nombre, \"Guadarrama\")) |&gt; \n  filter(nombre == \"Sierra Norte de Guadarrama\") \n\nst_write(gnat, \"data/geoinfo/pnat_guadarrama_limites.shp\")\n\n\n\nZEPAS\n\nData source\n\n\n# Según esto https://sig.mapama.gob.es/Docs/PDFServicios/RedNatura2000.pdf A=ZEPA, B=ZEC/LIC C= ZEC/LIC + ZEPA\n\n\nrnat &lt;- st_read(\"/Users/ajpelu/Downloads/rn2000-shp/Es_Lic_SCI_Zepa_SPA_Medalpatl_202401.shp\") |&gt; \n  filter(AC %in% c(\"CASTILLA Y LEÓN\", \"COMUNIDAD DE MADRID\")) |&gt; \n  mutate(tipo_name = case_when(\n    TIPO == \"A\" ~ \"ZEPA\", \n    TIPO == \"B\" ~ \"ZEC/LIC\", \n    TIPO == \"C\" ~ \"ZEPA y ZEC/LIC\")\n    )\n    \nst_write(rnat, \"data/geoinfo/red_natura.shp\")"
  }
]